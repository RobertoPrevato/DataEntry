/*!
 * DataEntry v1.0.1, forms validation library that implements Promise based validation of fields and forms,
 * automatic decoration of fields, localized error messages.
 * https://github.com/RobertoPrevato/DataEntry
 *
 * Copyright 2017, Roberto Prevato
 * https://robertoprevato.github.io
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
!function(a){if("undefined"!=typeof module&&module.exports)module.exports=a(this);else if("function"==typeof define&&define.amd){var b=this;define("dataentry",function(){return a(b)})}else this.Forms=a(this)}(function(a){function b(a){return typeof a==ba}function c(a){return typeof a==ca}function d(a){return typeof a==da}function e(a){return typeof a==aa&&a.constructor==Object}function f(a,b){return a&&a.hasOwnProperty(b)}function g(a,b){for(var c=0,d=a[ea];c<d;c++)if(b(a[c]))return a[c]}function h(a){return typeof HTMLElement===aa?a instanceof HTMLElement:a&&typeof a===aa&&null!==a&&1===a.nodeType&&typeof a.nodeName===ba}function i(a,c){if(b(a))return{name:a};if(e(a)){var d=a.name;return d||Z(c),a}Z(14,d)}function j(a,b){return $.t("errors."+a,b)}function k(a,b,c){if(b.search(/\s/)>-1){b=b.split(/\s/g);for(var d=0,e=b[ea];d<e;d++)k(a,b[d],c)}else typeof b==ba&&a.classList[c?"add":"remove"](b);return a}function l(a,b){return k(a,b,1)}function m(a,b){return k(a,b,0)}function n(a,b){return a&&a.classList.contains(b)}function o(a,b){return a.getAttribute(b)}function q(a){return o(a,"name")}function r(a){return"[name='"+q(a)+"']"}function s(a){return h(a)&&"password"==o(a,"type")}function t(a,b){return"checkbox"==a.type?(a.checked=1==b||/1|true/.test(b),void a.dispatchEvent(new Event("change"),{forced:!0})):void(a.value!=b&&(a.value=b,a.dispatchEvent(new Event("change"),{forced:!0})))}function u(a){var b=/input/i.test(a.tagName);if(b)switch(o(a,"type")){case"radio":case"checkbox":return a.checked}return a.value}function v(a){return a&&/^input$/i.test(a.tagName)&&/^(radio)$/i.test(a.type)}function w(a){return a&&(/^select$/i.test(a.tagName)||v(a))}function x(a){return a.nextElementSibling}function y(a,b){var c=a.nextElementSibling;return n(c,b)?c:_}function z(a,b){return a.querySelectorAll(b)}function A(a,b){return a.querySelectorAll(b)[0]}function B(a){var b=window.getComputedStyle(a);return"none"==b.display||"hidden"==b.visibility}function C(a){return document.createElement(a)}function D(a){a&&a.parentElement.removeChild(a)}function E(a,b){a.parentNode.insertBefore(b,a.nextSibling)}function F(a,b){a.appendChild(b)}function G(a){return typeof a==aa&&a[ea]?J(a,function(a){return a}):Array.prototype.slice.call(arguments)}function H(a){return ha(a)?[].concat.apply([],J(a,H)):a}function I(a,b){if(e(a)){for(var c in a)b(a[c],c);return a}if(!a||!a[ea])return a;for(var d=0,f=a[ea];d<f;d++)b(a[d],d)}function J(a,b){if(!a||!a[ea])return a;for(var c=[],d=0,e=a[ea];d<e;d++)c.push(b(a[d]));return c}function K(a,b){return a.indexOf(b)>-1}function L(a,b){for(var c=0,d=a[ea];c<d;c++)if(b(a[c]))return!0;return!1}function M(a,b){if(!a||!a.length)return[];for(var c=[],d=0,e=a[ea];d<e;d++)b(a[d])&&c.push(a[d]);return c}function N(a,b,c){var d={};if(c)for(var e in a)b.indexOf(e)==-1&&(d[e]=a[e]);else for(var g=0,h=b[ea];g<h;g++){var i=b[g];f(a,i)&&(d[i]=a[i])}return d}function O(){var a=arguments;if(a[ea]){if(1==a[ea])return a[0];for(var b,c,d=a[0],e=1,f=a[ea];e<f;e++)if(b=a[e])for(c in b)d[c]=b[c];return d}}function P(a,b,c){var d=function(){return b.apply(this,[a].concat(G(arguments)))};return d.bind(c||this),d}function Q(a){return d(a)?Q(a()):a}function R(a){setTimeout(a,0)}function S(a){if(a)return/select/i.test(a.tagName)&&B(a)&&n(a,"chosen-select")?x(a):a}function T(a){return v(a)?z(this.dataentry.element,r(a))[0]:a}function U(a){var b=T.call(this,a);if(b=S.call(this,b),/^radio|checkbox$/i.test(a.type)){var c=x(a);if(/label/i.test(c.tagName)&&a.id==o(c,"for"))return c}return b}function V(a,b){return a.match(b)}function W(a){var b="selectionStart",c="selectionEnd",d=a.target,e=d.value,f=a.keyCode||a.charCode,g=String.fromCharCode(f),h=(e.substr(d[b],d[c]),e.substr(0,d[b])),i=e.substr(d[c],e.length);return[h,g,i].join("")}function X(a,b){return{error:!0,message:a,field:b[0],params:b}}var Y={};Y.Version="1.0.1";var Z=function(a,b){throw"Error: "+a+(b?" `"+b+"`":"")+" https://github.com/RobertoPrevato/DataEntry/wiki/Errors#"+a};a.Promise||Z(1);var $;a.I?$=a.I:a.I18n?$=a.I18n:Z(2);var _,aa="object",ba="string",ca="number",da="function",ea="length",fa="replace",ga="schema",ha=function(a){return a instanceof Array};Y.Utils={};var ia=Y.Utils.String={format:function(a){var b=Array.prototype.slice.call(arguments,1);return a[fa](/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})},trim:function(a){return b(a)?a[fa](/^[\s]+|[\s]+$/g,""):a},removeMultipleSpaces:function(a){return b(a)?a[fa](/\s{2,}/g," "):a},removeLeadingSpaces:function(a){return b(a)?a[fa](/^\s+|\s+$/,""):a},hyphenize:function(a){if(!a)return"";for(;/[A-Z]/.test(a);)a=a[fa](/([a-z]?)([A-Z])/g,function(a,b,c){return b+(b?"-":"")+c.toLowerCase()});return a}},ja=Y.Harvesting={},ka=ja.DomHarvester=function(a){return this.initialize(a)};O(ka.prototype,{initialize:function(a){var b=this;return b.dataentry=a,b.element=a.element,b},dispose:function(){var a=this;return a.dataentry=a.element=null,a},getValues:function(){var a=this;return a.getValuesFromElement(a.element)},getValuesFromElement:function(a){var b={},c=this;a||(a=c.element);for(var d=z(a,"input,select,textarea"),e=0,f=d[ea];e<f;e++){var g=d[e],h=q(g);h&&!c.isSilent(g)&&(b[h]=c.getValueFromElement(g))}return b},isSilent:function(a){return n(a,"ug-silent")},getValueFromElement:function(a){if(c(a[ea])&&!h(a)){if(!a[ea])return;if(a[ea]>1){if(v(a[0])){var b=g(a,function(a){return a.checked});return b?b.value:_}var d=[];return I(a,function(a){d.push(u(a))}),d}a=a[0]}var e=this,f=q(a);if(f&&!e.isSilent(a))return u(a)},getFieldValue:function(a,b){return a||Z(12),this.getValueFromElement(b?b:z(this.element,'[name="'+a+'"]'))}});var la=ja.ContextHarvester=function(a){return this.initialize(a)};O(la.prototype,{initialize:function(a){a.context&&a.context.dataentryObjectGetter||Z(15);var b=this;return b.dataentry=a,b},dispose:function(){var a=this;return a.dataentry=a.element=null,a},getValues:function(){return this.getValuesFromContext(this.getContext())},getContext:function(){var a=this.dataentry.context.dataentryObjectGetter();return Q(a)},getValuesFromContext:function(a){var b,c={},d=this.dataentry.schema;for(b in d)if(f(a,b)){var e=Q(a[b]);c[b]=e}return c},getFieldValue:function(a){var b=this.getContext();return f(b,a)?Q(b[a]):null}});var ma=Y.Marking={},na=ma.Utils={checkElement:U,checkGroup:T,checkChosen:S},oa=ma.DomMarker=function(a){return this.initialize(a)};O(oa.prototype,na,{initialize:function(a){return this.dataentry=a,this.markStyle=a.options.markStyle,this},dispose:function(){return this.dataentry=null,this},getMessageElement:function(a,b){var c=this;if("tooltips"==c.markStyle){var d="ug-validation-wrapper",e=y(a,d);return e?e:b?c.getTooltipElement(a,b):null}var d="ug-message-element",e=y(a,d);return e?e:b?(e=C("span"),l(e,d),e):null},getOptions:function(a){var c=this.dataentry.schema[a.name],d=this.defaults,e=c?c.message:"right";return b(e)&&(e={position:e}),O({},d,e)},defaults:{position:"right"},getTooltipElement:function(a,b){var c="div",d=this.getOptions(a);return wrapper=C(c),tooltip=C(c),arrow=C(c),p=C("p"),l(wrapper,"ug-validation-wrapper"),l(tooltip,"tooltip validation-tooltip in "+d.position),l(arrow,"tooltip-arrow"),l(p,"tooltip-inner"),F(wrapper,tooltip),F(tooltip,arrow),F(tooltip,p),wrapper},setElementText:function(a,b){var c="textContent";return"tooltips"==this.markStyle?void(A(a,".tooltip-inner")[c]=b):void(a[c]=b)},removeMessageElement:function(a){var b=this;b.checkElement.call(b,a);var c=b.getMessageElement(a,!1);return c&&D(c),b},markFieldNeutrum:function(a){var b=this;return a=U.call(b,a),m(a,"ug-field-invalid ug-field-valid"),b.removeMessageElement(a)},markFieldValid:function(a){var b=this;return a=U.call(b,a),l(m(a,"ug-field-invalid"),"ug-field-valid"),b.removeMessageElement(a)},markFieldInfo:function(a,b){var c=this;a=U.call(c,a);var d=c.getMessageElement(a,!0);return c.setElementText(l(d,"ug-info"),b.message),E(a,d),c},markFieldInvalid:function(a,b){var c=this;a=U.call(c,a);var d=c.getMessageElement(a,!0);return c.setElementText(l(d,"ug-error"),b.message),E(a,d),c},markFieldTouched:function(a){return a=U.call(this,a),l(a,"ug-touched"),this},removeElements:function(){var a="tooltips"==this.markStyle?".ug-validation-wrapper":".ug-message-element";return I(z(this.dataentry.element,a),D),this}});var pa=Y.Formatting={SetValue:t,Rules:{trim:{fn:function(a,b){var c=/^[\s]+|[\s]+$/g;b.match(c)&&t(a,b[fa](c,""))}},removeSpaces:{fn:function(a,b){var c=/\s/g;b.match(c)&&t(a,b[fa](c,""))}},removeMultipleSpaces:{fn:function(a,b){var c=/\s{2,}/g;b.match(c)&&t(a,b[fa](c," "))}},cleanSpaces:{fn:function(a,b){if(b){var c=ia.trim(ia.removeMultipleSpaces(b));c!=b&&t(a,c)}}},integer:{fn:function(a,b){b&&/^0+/.test(b)&&t(a,b[fa](/^0+/,""))}}},PreRules:{integer:{fn:function(a,b){/^0+$/.test(b)&&t(a,"")}}}},qa=Y.Formatting.Formatter=function(a){return this.initialize(a)};O(qa.prototype,{initialize:function(a){var b=pa.Rules,c=this;return c.rules=b,c.dataentry=a,c.marker=a.marker,c},dispose:function(){var a=this;return a.rules=a.dataentry=a.marker=null,a},format:function(a,c,d,e,f){var g=this;if(b(a)){var h=a;return g.rules[h]?g.rules[h].fn.call(c,d,e,f):Z(4,h),g}for(var j=0,k=a[ea];j<k;j++){var l=i(a[j],16);g.format(l.name,c,d,e,l.params)}return g},markFieldFormatted:function(a,b){return this.marker.markFieldInfo(a,b),this}});var ra=function(a,b){return!!(K([8,0,37,39,9],b)||a.ctrlKey&&K([120,118,99,97,88,86,67],b))},sa=function(a){return String.fromCharCode(a)},ta=Y.Constraints={PermittedCharacters:ra,StringFromCode:sa,ForeseeValue:W,integer:function(a,b){var b=a.keyCode||a.charCode,c=sa(b);return!(!ra(a,b)&&!V(c,/[0-9]/))},letters:function(a,b){var b=a.keyCode||a.charCode,c=sa(b);return!(!ra(a,b)&&!V(c,/[a-zA-Z]/))},digits:function(a,b){var b=a.keyCode||a.charCode,c=sa(b);return!(!ra(a,b)&&!V(c,/\d/))}};Y.Validation={GetError:X,LocalizeError:j,Rules:{none:{fn:function(){return!0}},noSpaces:{fn:function(a,b,c){return!b||(!b.match(/\s/)||X(j("spacesInValue"),arguments))}},remote:{deferred:!0,fn:function(a,b,c,d){return d||Z(7),d.apply(a,arguments)}},required:{fn:function(a,c,d,e){b(e)&&(e={message:e});var f={message:j(w(a)?"selectValue":"emptyValue")},g=O(f,e);if(v(a)){var h=z(this.element,r(a));return!!L(h,function(a){return a.checked})||X(g.message,arguments)}return!(!c||c.toString().match(/^\s+$/))||X(g.message,arguments)}},integer:{fn:function(a,b,d,e){if(!b)return!0;if(!/^\d+$/.test(b))return X(j("notInteger"),arguments);if(e){var f=parseInt(b);if(c(e.min)&&f<e.min)return X(j("minValue",e),arguments);if(c(e.max)&&f>e.max)return X(j("maxValue",e),arguments)}return!0}},letters:{fn:function(a,b,c){return!b||(!!/^[a-zA-Z]+$/.test(b)||X(j("canContainOnlyLetters"),arguments))}},digits:{fn:function(a,b,c){return!b||(!!/^\d+$/.test(b)||X(j("canContainOnlyDigits"),arguments))}},maxLength:{fn:function(a,b,c,d){return!b||(!(b[ea]>d)||X(j("maxLength",{length:d}),arguments))}},minLength:{fn:function(a,b,c,d){return!b||(!(b[ea]<d)||X(j("minLength",{length:d}),arguments))}},mustCheck:{fn:function(a,b,c,d){return!!a.checked||X(j("mustBeChecked"),arguments)}}}};var ua=Y.Validation.Validator=function(a){return this.initialize(a)};O(ua.prototype,{ev:"blur",defaults:{invalidClass:"ug-field-invalid",message:j("invalidValue"),params:[]},initialize:function(a){var b=this,c=Y.Validation.Rules;return b.rules=c,b.dataentry=a,b.context=a,b.marker=a.marker,b},dispose:function(){var a=this;return a.marker=a.rules=a.options=a.context=a.dataentry=null,a},checkValidator:function(a){this.rules[a]||Z(3,a)},getValidator:function(a){var c=this,d=c.defaults,f=c.rules;return b(a)?(c.checkValidator(a),O({name:a},d,f[a])):e(a)?(a.name||Z(6),c.checkValidator(a.name),O({},d,a,f[a.name])):void Z(14)},getValidators:function(a){var b={direct:[],deferred:[]},c=this;return I(a,function(a){var d=c.getValidator(a);d.deferred?b.deferred.push(d):b.direct.push(d)}),b},validate:function(a,b,c,d){var e=this.getValidationChain(a);return this.chain(e,b,c,d)},getValidationChain:function(a){var b=this.getValidators(a),c=[],d=this;return I(b.direct,function(a){a.fn=d.makeValidatorDeferred(a.fn),c.push(a)}),I(b.deferred,function(a){c.push(a)}),c},makeValidatorDeferred:function(a){var b=this;return P(a,function(a){var c=G(arguments);return new Promise(function(d,e){var f=a.apply(b.context,c.slice(1,c[ea]));d(f)})})},chain:function(a){if(!a[ea])return new Promise(function(a){a([])});a=J(a,function(a){return d(a)?{fn:a,params:[]}:a});var b=0,c=[],e=this,f=G(arguments).slice(1,arguments[ea]);return new Promise(function(d,g){function h(a){return a.field||(a.field=this),c.push(a),a.error?d(c):void k()}function i(a){c.push({error:!0,message:j("failedValidation")}),g(c)}function k(){b++,b==a[ea]?d(c):a[b].fn.apply(e.context,f.concat(a[b].params)).then(h,i)}a[b].fn.apply(e.context,f.concat(a[b].params)).then(h,i)})}});var va=Y.DataEntry=function(a){a||Z(8),a.element||Z(8),a[ga]||Z(8);var b=this;b.baseProperties;return O(b,N(a,b.baseProperties)),b.options=O({},b.defaults,N(a,b.baseProperties,1)),b.initialize(a)};return O(va.prototype,{defaults:{allowImplicitConstraints:!0,allowImplicitFormat:!0,markStyle:"tooltips"},baseProperties:["element","schema","context","events"],initialize:function(a){var b=this;return b.marker=new b.markerType(b),b.harvester=new b.harvesterType(b),b.validator=new b.validatorType(b),b.formatter=new b.formatterType(b),b.fn={},b.handlers=[],b.bindEvents().checkElement().restoreValues(),l(b.element,"ug-dataentry"),b},dispose:function(){var a=this;return a.removeValidation().undelegateEvents(),I(["validator","formatter","harvester","marker"],function(b){a[b].dispose(),a[b]=null}),a.fn=a.element=null,a},string:ia,harvesterType:ka,markerType:oa,validatorType:ua,formatterType:qa,validate:function(a,b){var c=this;a&&d(a)&&(a=a.call(c)),a&&!ha(a)&&Z(9),c.element||Z(10);var e=c[ga];e||Z(11);var f=c.context||c;return new Promise(function(d,g){var h=[];for(var i in e)a&&!K(a,i)||h.push(c.validateField(i,b));Promise.all(h).then(function(a){var b=H(a),e=M(b,function(a){return a&&a.error});e[ea]?(e[0].field.focus(),d.call(f,{valid:!1,errors:e})):d.call(f,{valid:!0,values:c.harvester.getValues()})},function(a){g.apply(f,[a])})})},validateField:function(a,b){b=O({elements:null,decorateField:!0,onlyTouched:!1},b||{});var c=this,d=c[ga];a||Z(12),d||Z(11),d[a]&&d[a].validation||Z(13,a);var e=b.elements?b.elements:z(c.element,"[name='"+a+"']");if(b.onlyTouched&&(e=M(e,function(a){return n(a,"ug-touched")})),e[ea]){var f=c.validator,h=f.marker,i=d[a],j=c.getFieldValidationDefinition(i.validation),k=[];return I(e,function(d){var e=c.getFieldValue(a,d);b.decorateField&&h.markFieldNeutrum(d);var i;i=b.decorateField?f.validate(j,d,e).then(function(a){for(var b=0,c=a[ea];b<c;b++){var e=a[b];if(e.error)return h.markFieldInvalid(d,{message:e.message}),a}return h.markFieldValid(d),a},function(a){var b=g(a,function(a){return a.error});h.markFieldInvalid(d,{message:b.message})}):f.validate(j,d,e),k.push(i)}),new Promise(function(a,b){Promise.all(k).then(function(){a(G(arguments))})})}},getFieldValidationDefinition:function(a){return d(a)?a.apply(this.context||this,[]):a},getFieldValue:function(a,b){var c=this[ga][a];return c.valueGetter?c.valueGetter.call(this.context,b):this.harvester.getFieldValue(a,b)},bindEvents:function(){return this.delegateEvents()},delegateEvents:function(){var a=this,b=a.getEvents(),c=a.element,e=/^(\S+)\s*(.*)$/;for(var f in b){var g=b[f];if(d(g)||(g=a.fn[g]),g){var h=f.match(e),i=h[1],j=h[2];g=g.bind(a),a.setEventListener(c,i,j,g)}}return a},setEventListener:function(a,b,c,d){var e=function(b){var e=(b.currentTarget,z(a,c));if(L(e,function(a){return b.target===a})){var f=d(b);return f===!1&&b.preventDefault(),f}};return this.handlers.push({type:b,fn:e}),a.addEventListener(b,e,!0),this},undelegateEvents:function(){var a=this,b=a.element;return I(a.handlers,function(a){b.removeEventListener(a.type,a.fn,!0)}),a.handlers=[],a},checkElement:function(){var a=this,b=a.element;return b&&/form/i.test(b.tagName)&&b.addEventListener("submit",function(a){a.preventDefault()}),a},restoreValues:function(){var a=this,b=a.element;if(!b.dataset.memory)return a;var c,d,e=a[ga],f=a.getStorage();for(c in e){var g=f.getItem(a.getMemoryKey(c));g&&(d=A(b,"[name='"+c+"']"),d&&t(d,g))}return a},getEvents:function(){var a=this,b=a.events||{};return d(b)&&(b=b.call(a)),b=O({},b,a.getValidationDefinition(),a.getPreFormattingDefinition(),a.getMetaEvents(),a.getConstraintsDefinition(),a.getMemoryDefinition())},getValidationDefinition:function(){var a=this,c=a[ga],e=a.marker;if(!c)return{};var f,h={};for(f in c){var i=c[f].validationEvent,j=a.string.format("{0} [name='{1}']",i||a.validator.ev,f),k="validation_"+f;h[j]=k,a.fn[k]=function(c,f){if(!a.validationActive)return!0;f==_&&(f=!1);var h=c.target,i=o(h,"name");e.markFieldNeutrum(h);var j=a[ga][i],k=a.getFieldValidationDefinition(j.validation),l=a.getFieldValue(i,h);a.validator.validate(k,h,l,f).then(function(c){var f=g(c,function(a){return a.error});if(f)e.markFieldInvalid(h,{message:f.message});else{e.markFieldValid(h);var i=o(h,"name"),j=a[ga][i].format;if(d(j)&&(j=j.call(a.context||a,h,l)),j)a.formatter.format(j,a,h,l);else if(a.options.allowImplicitFormat)for(var m=0,n=k[ea];m<n;m++){var i=b(k[m])?k[m]:k[m].name;i&&a.formatter.rules[i]&&a.formatter.format(i,a,h,l)}}},function(a){if(a)for(var b=0,c=a[ea];b<c;b++)a[b]&&!a[b].error||e.markFieldInvalid(h,{message:a[b].message})})}}return h},getPreFormattingDefinition:function(){var a=this,b=a[ga];if(!b)return{};var c,d={};for(c in b){var e=a.getFieldPreformatRules(c);if(e&&e[ea]){var f="focus",g=a.string.format('{0} [name="{1}"]',f,c),h="preformat_"+c;d[g]=h,a.fn[h]=function(b,c){for(var d=b.target,e=o(d,"name"),f=a.getFieldPreformatRules(e),g=0,h=f[ea];g<h;g++){var j=i(f[g],16),k=Y.Formatting.PreRules[j.name];k.fn.call(a.context||a,d,u(d),j.params)}}}}return d},getFieldPreformatRules:function(a){var b=this,c=b[ga][a];if(!c)return[];var e=c.preformat;if(!e&&b.options.allowImplicitFormat&&!d(c.validation)){e=[];for(var f=b.getFieldValidationDefinition(c.validation),g=0,h=f[ea];g<h;g++){var i=f[g].name||f[g];Y.Formatting.PreRules[i]&&e.push(i)}}return e},getMetaEvents:function(){var a=function(a){return this.formatter.marker.markFieldTouched(a.target),this.validationActive=!0,!0},b=function(a,b){var c=this;c.formatter.marker.markFieldTouched(a.target),c.validationActive=!0;var d=a.target,e=d.name;if(f(c[ga],e)){var g=/radio/i.test(d.type)?z(c.element,r(d)):[a.target];R(function(){c.validateField(e,{elements:g})})}};return{"keypress input,select,textarea":a,"keydown input,select,textarea":a,"change select":b,"change input[type='radio']":b,"change input[type='checkbox']":b}},autobindFormat:function(){var a=this,c=a[ga],e=a.options;if(c&&!e.strictFormat&&!e.formatBound){for(var g in c){var h=c[g];h.format||(h.format=[]);var i=h.format,j=h.validation;if(j){var j=j;if(d(j))continue;for(var k=0,l=j[ea];k<l;k++){var m=b(j[k])?j[k]:j[k].name;f(a.formatter.rules,m)&&!K(i,m)&&i.push(m)}}}return a.options.formatBound=!0,a}},getConstraintsDefinition:function(){var a=this,c=a[ga];if(!c)return{};var e,g={};for(e in c){var h=a.string.format("{0} [name='{1}']","keypress",e),i="constraint_"+e,j=c[e],k=j.constraint;if(k)d(k)&&(k=k.call(a.context||a)),f(ta,k)?(g[h]=i,a.fn[i]=ta[k]):Z(5,k);else if(a.options.allowImplicitConstraints){var l=j.validation;if(l){d(l)&&(l=l.call(a.context||a));for(var m=0,n=l[ea];m<n;m++){var o=b(l[m])?l[m]:l[m].name;f(ta,o)&&(g[h]=i,a.fn[i]=ta[o])}}}}return g},getStorage:function(){return sessionStorage},getMemoryKey:function(a){var b=location.pathname+location.hash;return b+":::"+a},memorize:function(a){var b=this,c=b[ga],d=b.getStorage();setTimeout(function(){var e=a.target,f=q(e);if(f){var g=c[f];if(g&&g.mem!==!1&&!s(e)){var h=u(e),i=b.getMemoryKey(f);d.setItem(i,h)}}},50)},getMemoryDefinition:function(){var a=this;if(!a.element.dataset.memory||!a.getStorage())return null;var b=a.memorize.bind(a);return{"keypress input,textarea":b,"paste input,textarea":b,"cut input,textarea":b,"change select":b,"change input[type='checkbox']":b,"change input[type='radio']":b}},removeValidation:function(a){return this.marker.removeElements(),this}}),Y});